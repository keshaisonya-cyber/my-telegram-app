<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reels Music Downloader</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: sans-serif;
            background-color: var(--tg-theme-bg-color, #fff);
            color: var(--tg-theme-text-color, #000);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        input {
            width: 100%;
            max-width: 300px;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid #ccc;
            margin-bottom: 20px;
            box-sizing: border-box;
        }
        .button-group {
            display: flex;
            gap: 10px; /* –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∫–Ω–æ–ø–∫–∞–º–∏ */
            width: 100%;
            max-width: 300px;
        }
        button {
            flex: 1; /* –ö–Ω–æ–ø–∏ –±—É–¥—É—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π —à–∏—Ä–∏–Ω—ã */
            background-color: var(--tg-theme-button-color, #248bed);
            color: var(--tg-theme-button-text-color, #fff);
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
        }
        button:active {
            filter: brightness(0.8); /* –≠—Ñ—Ñ–µ–∫—Ç –Ω–∞–∂–∞—Ç–∏—è */
        }
       
    </style>
</head>
<body>
    <h2>üéµ Reels Downloader</h2>
    <P>–í—Å—Ç–∞–≤—å —Å—Å—ã–ª–∫—É –Ω–∞ Reels –Ω–∏–∂–µ:</p>
    <input type="text" id="url">
    
    <div class="button-group">
        <button id="btnAudio">–ê—É–¥–∏–æ üîä</button>
        <button id="btnVideo">–í–∏–¥–µ–æ üé¨</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        // –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ "Unknown", –∑–Ω–∞—á–∏—Ç –æ—Ç–∫—Ä—ã—Ç–æ –Ω–µ –≤ Telegram
        if (tg.platform === 'unknown') {
            document.body.innerHTML = '<h2 style="text-align: center; margin-top: 50px;">–ò–∑–≤–∏–Ω–∏—Ç–µ, —ç—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ Telegram –±–æ—Ç–∞.</h2>';
            throw new Error("–î–æ—Å—Ç—É–ø –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: –æ—Ç–∫—Ä—ã—Ç–æ –≤–Ω–µ Telegram");
        }
        
        const urlInput = document.getElementById('url');

        // –°–æ–æ–±—â–∞–µ–º Telegram, —á—Ç–æ –ø—Ä–∏–¥–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ
        tg.ready();

       
 
        function startDownload(type) {
            const rawUrl = urlInput.value.trim();
           
            //1. –ü—Ä–æ—Å—Ç–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç XSS –∏ –ø—É—Ç—ã—Ö —Å—Ç—Ä–æ–∫
            if (!rawUrl) {
                tg.showAlert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É");
                return; //–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –µ—Å–ª–∏ –ø—É—Å—Ç–æ
            }

            if (rawUrl.length > 199) {
                tg.showAlert("–û—à–∏–±–∫–∞: –°—Å—ã–ª–∫–∞ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–∞—è");
                return; // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤—ã—Ö–æ–¥–∏, —á—Ç–æ–±—ã –∫–æ–¥ –Ω–µ –ø–æ—à–µ–ª –¥–∞–ª—å—à–µ!
            }

            // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞: —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —Å—Å—ã–ª–∫–æ–π –Ω–∞ Instagram Reels –∏–ª–∏ YouTube
            // –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞—á–∞–ª–æ —Å—Å—ã–ª–∫–∏
            const instPattern = /^https?:\/\/(www\.)?instagram\.com\/(reels|reel|p)\/[\w-]+\/?/i;
            const ytPattern = /^https?:\/\/(www\.)?(youtube\.com|youtu\.be)\/.+/i;

            if (instPattern.test(rawUrl) || ytPattern.test(rawUrl)) {
                // –ï—Å–ª–∏ –≤—Å–µ –æ–∫, —Ä–∞–±–æ—Ç–∞–µ–º –¥–∞–ª—å—à–µ
                tg.showAlert("–°—Å—ã–ª–∫–∞ –ø—Ä—è–Ω—è—Ç–∞! –ù–∞—á–∏–Ω–∞—é —Ä–∞–±–æ—Ç—É...");


                // –¢—É—Ç –≤ –±—É–¥—É—â–µ–º –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                console.log("Valid URL:", rawUrl);
            } else {
                //–ï—Å–ª–∏ –≤–≤–µ–ª–∏ <script> –∏–ª–∏ —Å—Å—ã–ª–∫—É –Ω–∞ –¥—Ä—É–≥–æ–π —Å–∞–π—Ç
                tg.showAlert("–û—à–∏–±–∫–∞: –≠—Ç–æ –Ω–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ —Ä–∞–±–æ—á—É—é —Å—Å—ã–ª–∫—É. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥—Ä–µ—Å");
            }
            
        }            
        

        // –í–∞–∂–Ω–æ: –°–≤—è–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –æ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π
        document.getElementById('btnAudio').addEventListener('click', () => startDownload('AUDIO'));
        document.getElementById('btnVideo').addEventListener('click', () => startDownload('VIDEO'));
    </script>
</body>
</html>
